<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solicitar Ajuda - Ong da Rosinha</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
    <script>

        const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");
        
        const currentTheme = localStorage.getItem("theme");
        if (currentTheme === "dark") {
            document.documentElement.setAttribute("data-theme", "dark");
        } else if (currentTheme === "light") {
            document.documentElement.setAttribute("data-theme", "light");
        } else if (prefersDarkScheme.matches) {
            document.documentElement.setAttribute("data-theme", "dark");
        }
    </script>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <img src="../assets/logo.png" alt="Ong da Rosinha Logo">
                <h1>Ong da Rosinha</h1>
            </div>
            <nav>
                <ul class="nav-menu">
                    <li><a href="home.html">Início</a></li>
                    <li><a href="doacoes.html">Doações</a></li>
                    <li><a href="solicitar.html" class="active">Solicitar Ajuda</a></li>
                    <li><a href="login.html" class="btn btn-outline">Entrar</a></li>
                </ul>
            </nav>
            <button class="theme-toggle" id="theme-toggle">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </header>

    <!-- Solicitar Ajuda Hero Section -->
    <section class="page-hero">
        <div class="container">
            <h2>Solicitar Ajuda</h2>
            <p>Preencha o formulário abaixo para solicitar ajuda. Nossa equipe analisará seu pedido e entrará em contato o mais breve possível.</p>
        </div>
    </section>

    <!-- Formulário de Solicitação -->
    <section class="solicitar-section">
        <div class="container">
            <div class="solicitar-container card">
                <form id="solicitar-form">
                    <div class="form-group">
                        <label for="categoria" class="form-label">Categoria de Ajuda</label>
                        <select id="categoria" class="form-control" required>
                            <option value="">Selecione uma categoria</option>
                            <option value="1">Alimentos</option>
                            <option value="2">Roupas</option>
                            <option value="3">Móveis</option>
                            <option value="4">Material Escolar</option>
                            <option value="5">Brinquedos</option>
                            <option value="6">Medicamentos</option>
                            <option value="7">Higiene Pessoal</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="descricao" class="form-label">Descrição da Necessidade</label>
                        <textarea id="descricao" class="form-control" rows="5" placeholder="Descreva detalhadamente o que você está precisando e por quê..." required></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="quantidade" class="form-label">Quantidade</label>
                            <input type="number" id="quantidade" class="form-control" min="1" value="1" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="urgencia" class="form-label">Nível de Urgência</label>
                            <select id="urgencia" class="form-control" required>
                                <option value="baixa">Baixa</option>
                                <option value="media" selected>Média</option>
                                <option value="alta">Alta</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Seus Dados</label>
                        <p class="form-help-text">Para solicitar ajuda, você precisa estar cadastrado como beneficiário. Se já possui cadastro, faça login. Caso contrário, preencha seus dados abaixo.</p>
                    </div>
                    
                    <div id="login-section" style="display: none;">
                        <p>Você está logado como <span id="user-name">Nome do Usuário</span>.</p>
                    </div>
                    
                    <div id="cadastro-section">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="nome" class="form-label">Nome Completo</label>
                                <input type="text" id="nome" class="form-control" placeholder="Seu nome completo" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="cpf" class="form-label">CPF</label>
                                <input type="text" id="cpf" class="form-control" placeholder="000.000.000-00" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="email" class="form-label">Email</label>
                                <input type="email" id="email" class="form-control" placeholder="Seu email" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="telefone" class="form-label">Telefone</label>
                                <input type="tel" id="telefone" class="form-control" placeholder="(00) 00000-0000" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="endereco" class="form-label">Endereço</label>
                            <input type="text" id="endereco" class="form-control" placeholder="Rua, número, complemento" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cidade" class="form-label">Cidade</label>
                                <input type="text" id="cidade" class="form-control" placeholder="Sua cidade" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="estado" class="form-label">Estado</label>
                                <select id="estado" class="form-control" required>
                                    <option value="">Selecione</option>
                                    <option value="AC">AC</option>
                                    <option value="AL">AL</option>
                                    <option value="AP">AP</option>
                                    <option value="AM">AM</option>
                                    <option value="BA">BA</option>
                                    <option value="CE">CE</option>
                                    <option value="DF">DF</option>
                                    <option value="ES">ES</option>
                                    <option value="GO">GO</option>
                                    <option value="MA">MA</option>
                                    <option value="MT">MT</option>
                                    <option value="MS">MS</option>
                                    <option value="MG">MG</option>
                                    <option value="PA">PA</option>
                                    <option value="PB">PB</option>
                                    <option value="PR">PR</option>
                                    <option value="PE">PE</option>
                                    <option value="PI">PI</option>
                                    <option value="RJ">RJ</option>
                                    <option value="RN">RN</option>
                                    <option value="RS">RS</option>
                                    <option value="RO">RO</option>
                                    <option value="RR">RR</option>
                                    <option value="SC">SC</option>
                                    <option value="SP">SP</option>
                                    <option value="SE">SE</option>
                                    <option value="TO">TO</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="cep" class="form-label">CEP</label>
                                <input type="text" id="cep" class="form-control" placeholder="00000-000" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="renda_familiar" class="form-label">Renda Familiar</label>
                                <input type="number" id="renda_familiar" class="form-control" placeholder="Renda familiar mensal" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="num_dependentes" class="form-label">Número de Dependentes</label>
                                <input type="number" id="num_dependentes" class="form-control" placeholder="Quantas pessoas dependem de você" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="situacao_moradia" class="form-label">Situação de Moradia</label>
                            <select id="situacao_moradia" class="form-control" required>
                                <option value="">Selecione</option>
                                <option value="Própria">Própria</option>
                                <option value="Alugada">Alugada</option>
                                <option value="Cedida">Cedida</option>
                                <option value="Ocupação">Ocupação</option>
                                <option value="Situação de Rua">Situação de Rua</option>
                                <option value="Abrigo">Abrigo</option>
                                <option value="Outros">Outros</option>
                            </select>
                        </div>
                        
                        <div class="form-group form-check">
                            <input type="checkbox" id="termos" class="form-check-input" required>
                            <label for="termos" class="form-check-label">Declaro que as informações fornecidas são verdadeiras e concordo com os <a href="termos.html">Termos de Uso</a> e <a href="privacidade.html">Política de Privacidade</a></label>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn">Enviar Solicitação</button>
                        <a href="login.html" class="btn btn-outline" id="login-btn">Já tenho cadastro</a>
                    </div>
                </form>
            </div>
        </div>
    </section>

    <!-- Como Funciona -->
    <section class="how-it-works">
        <div class="container">
            <h2 class="section-title">Como Funciona o Processo de Solicitação</h2>
            <div class="steps-container">
                <div class="step-card card">
                    <div class="card-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <h3 class="card-title">1. Envie sua Solicitação</h3>
                    <p class="card-text">Preencha o formulário com suas informações e necessidades.</p>
                </div>
                <div class="step-card card">
                    <div class="card-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <h3 class="card-title">2. Análise</h3>
                    <p class="card-text">Nossa equipe analisará seu pedido e verificará a disponibilidade de doações.</p>
                </div>
                <div class="step-card card">
                    <div class="card-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <h3 class="card-title">3. Aprovação</h3>
                    <p class="card-text">Após aprovação, você será notificado sobre a disponibilidade da doação.</p>
                </div>
                <div class="step-card card">
                    <div class="card-icon">
                        <i class="fas fa-hands-helping"></i>
                    </div>
                    <h3 class="card-title">4. Recebimento</h3>
                    <p class="card-text">Combinamos a entrega ou retirada da doação conforme sua disponibilidade.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>AjudaSolidária</h3>
                    <p>Conectando quem precisa com quem pode ajudar.</p>
                    <div class="social-icons">
                        <a href="#"><i class="fab fa-facebook-f"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
                <div class="footer-section">
                    <h3>Links Rápidos</h3>
                    <ul>
                        <li><a href="home.html">Início</a></li>
                        <li><a href="doacoes.html">Doações</a></li>
                        <li><a href="solicitar.html">Solicitar Ajuda</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h3>Contato</h3>
                    <ul>
                        <li><i class="fas fa-map-marker-alt"></i> Rua Mesquita, 125 - NOva Iguaçu</li>
                        <li><i class="fas fa-phone"></i> (21) 95933-6293</li>
                    </ul>
                </div>
            </div>
            <div class="copyright">
                <p>&copy; 2025 Ong da Rosinha. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <script>
        // Alternar tema
        document.getElementById("theme-toggle").addEventListener("click", function() {
            let currentTheme = document.documentElement.getAttribute("data-theme");
            let targetTheme = "light";
            
            if (currentTheme === "light") {
                targetTheme = "dark";
                this.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                this.innerHTML = '<i class="fas fa-moon"></i>';
            }
            
            document.documentElement.setAttribute("data-theme", targetTheme);
            localStorage.setItem("theme", targetTheme);
        });
        
        // Atualizar ícone do botão de tema
        window.addEventListener("DOMContentLoaded", function() {
            const themeToggle = document.getElementById("theme-toggle");
            const currentTheme = document.documentElement.getAttribute("data-theme");
            
            if (currentTheme === "dark") {
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
            
            // Verificar se o usuário está logado
            const isLoggedIn = localStorage.getItem("isLoggedIn");
            const userType = localStorage.getItem("userType");
            const userName = localStorage.getItem("userName");
            
            if (isLoggedIn === "true" && (userType === "beneficiario" || userType === "organizacao")) {
                document.getElementById("login-section").style.display = "block";
                document.getElementById("cadastro-section").style.display = "none";
                document.getElementById("login-btn").style.display = "none";
                document.getElementById("user-name").textContent = userName || "Usuário";
            } else {
                document.getElementById("login-section").style.display = "none";
                document.getElementById("cadastro-section").style.display = "block";
                document.getElementById("login-btn").style.display = "inline-block";
            }
            
            // Verificar se há um item pré-selecionado (vindo da página de doações)
            const urlParams = new URLSearchParams(window.location.search);
            const itemId = urlParams.get('item');
            
            if (itemId) {
                
                console.log("Item pré-selecionado:", itemId);
                
                document.getElementById("descricao").value = "Estou solicitando o item #" + itemId + " que vi na página de doações.";
            }
        });
        
        // Envio do formulário
        document.getElementById("solicitar-form").addEventListener("submit", function(e) {
            e.preventDefault();
            
            // Verificar se o usuário está logado
            const isLoggedIn = localStorage.getItem("isLoggedIn");
            
            // Coletar dados do formulário
            const formData = {
                categoria_id: document.getElementById("categoria").value,
                descricao: document.getElementById("descricao").value,
                quantidade: document.getElementById("quantidade").value,
                urgencia: document.getElementById("urgencia").value
            };
            
            // Se não estiver logado, coletar dados de cadastro
            if (isLoggedIn !== "true") {
                formData.cadastro = {
                    nome: document.getElementById("nome").value,
                    cpf: document.getElementById("cpf").value,
                    email: document.getElementById("email").value,
                    telefone: document.getElementById("telefone").value,
                    endereco: document.getElementById("endereco").value,
                    cidade: document.getElementById("cidade").value,
                    estado: document.getElementById("estado").value,
                    cep: document.getElementById("cep").value,
                    renda_familiar: document.getElementById("renda_familiar").value,
                    num_dependentes: document.getElementById("num_dependentes").value,
                    situacao_moradia: document.getElementById("situacao_moradia").value
                };
            }
            
            console.log("Solicitação:", formData);
            
            // Simulação de envio bem-sucedido
            alert("Solicitação enviada com sucesso! Você será redirecionado para a página de confirmação.");
            window.location.href = "resposta.html?tipo=solicitacao&status=sucesso";
        });
    </script>
</body>
</html>
